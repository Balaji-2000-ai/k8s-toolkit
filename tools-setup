kubectl: The third party command-line tool used to interact with Kubernetes clusters

#minikube
#2CPU's or more, 2GB of free memory, 20GB of free disk space & Docker
#ubuntu

apt update -y
apt upgrade -y
apt install curl wget apt-transport-https -y
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh
curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
mv minikube-linux-amd64 /usr/local/bin/minikube
chmod +x /usr/local/bin/minikube
minikube version
curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"
curl -LO "https://dl.k8s.io/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl.sha256"
echo "$(cat kubectl.sha256) kubectl" | sha256sum --check
install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl
minikube start --driver=docker --force


#minikube-RedHat
vim .bashrc:
export PATH=$PATH:/usr/local/bin/
source .bashrc
yum install docker -y
systemctl start docker
systemctl status docker
curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"
sudo mv kubectl /usr/local/bin/kubectl
sudo chmod +x /usr/local/bin/kubectl
curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
sudo install minikube-linux-amd64 /usr/local/bin/minikube
sudo yum install iptables -y
yum install conntrack -y
minikube start --driver=docker --force
minikube status 




#kops:30GB EBS Volume
1. Attach IAM Role to the Instance:
Go to Actions → Security → Modify IAM role and attach the required IAM role to the EC2 instance
2. Install AWS CLI:
curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
unzip awscliv2.zip
sudo ./aws/install
3. Update PATH in .bashrc:
export PATH=$PATH:/usr/local/bin/
4. Reload shell configuration:
source .bashrc
5. Install KOPS:
curl -Lo kops https://github.com/kubernetes/kops/releases/download/$(curl -s https://api.github.com/repos/kubernetes/kops/releases/latest | grep tag_name | cut -d '"' -f 4)/kops-linux-amd64
chmod +x kops
sudo mv kops /usr/local/bin/kops
6. Install kubectl:
curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"
chmod +x kubectl
mv kubectl /usr/local/bin
export KOPS_STATE_STORE=s3://bucket_name



#MetricsServer-Scaling
kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
kubectl get deployment metrics-server -n kube-system


#Ingress
#Ingress-Controller
kubectl create -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.1/deploy/static/provider/cloud/deploy.yaml


#helm
curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
chmod 700 get_helm.sh
./get_helm.sh
helm version


#ARGOCD using Helm. Username=admin
kubectl create namespace argocd
kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml
kubectl get all -n argocd
#EXPOSE ARGOCD SERVER:
kubectl patch svc argocd-server -n argocd -p '{"spec": {"type": "LoadBalancer"}}'
yum install jq -y
export ARGOCD_SERVER='kubectl get svc argocd-server -n argocd -o json | jq --raw-output '.status.loadBalancer.ingress[0].hostname''
echo $ARGOCD_SERVER
kubectl get svc argocd-server -n argocd -o json | jq --raw-output .status.loadBalancer.ingress[0].hostname
#The above command will provide load balancer URL to access ARGO CD
export ARGO_PWD='kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d'
echo $ARGO_PWD
kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d
#The above command to provide password to access argo cd



#Prometheus & Grafana using HELM. Username=admin. We had set the password to 'EKS!sAWSome'

#Prometheus & Grafana namespace to isolate Prometheus and Grafana components
kubectl create ns prometheus
kubectl create ns Grafana

#Install Helm
curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
chmod 700 get_helm.sh
./get_helm.sh
helm version

#Install Metrics Server
kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
kubectl get deployment metrics-server -n kube-system

#Add Prometheus & Grafana Helm repositories
helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
helm repo add grafana https://grafana.github.io/helm-charts
helm repo list
helm repo update

#Install Prometheus & Grafana Using Helm
helm install prometheus prometheus-community/prometheus --namespace prometheus --set alertmanager.persistentVolume.storageClass="gp2" --set server.persistentVolume.storageClass="gp2"
helm install grafana grafana/grafana --namespace grafana --set persistence.storageClassName="gp2" --set persistence.enabled=true --set adminPassword='EKS!sAWSome' --set  service.type=LoadBalancer

#After installing Grafana, Helm will output a command to retrieve the LoadBalancer DNS name. Update Security Group to allow inbound traffic on Grafana’s port

#Grafana Dashboard Setup with Prometheus Data Source
#Add Prometheus as a Data Source
Data Sources → Add data source → Prometheus (Prometheus Server URL: http://prometheus-server.prometheus.svc.cluster.local/)-> Save & Test

#Import Dashboard 6417 (Kubernetes Cluster Monitoring). This imports the “Kubernetes Cluster Monitoring (via Prometheus)” dashboard
Dashboards → New → Import-> Enter Dashboard ID: 6417-> Click Load-> Select Prometheus as the data source-> Click Import









